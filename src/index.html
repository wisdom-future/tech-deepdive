<!-- 这是房子的主体框架（The House）。它包含了地基、承重墙、屋顶、水电总管路，以及所有房间的“空房间”结构。 -->

<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>技术洞察引擎</title>
  <base target="_top">
  <!-- 引入Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.1.0/dist/echarts-wordcloud.min.js"></script>

  <!-- 引入Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/markdown-it@14.0.0/dist/markdown-it.min.js"></script>
  
  <!-- 配置Tailwind -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#0000ff',
            secondary: '#6c757d',
            success: '#28a745',
            warning: '#ffc107',
            error: '#dc3545',
            info: '#17a2b8',
            group1: '#e9eff4',
            group2: '#dbe4ec',
            group3: '#cbdae5',
            navDark: '#2c3e50',
          },
          fontFamily: {
            sans: ['-apple-system', 'BlinkMacSystemFont', '"Segoe UI"', 'Roboto', '"Helvetica Neue"', 'Arial', 'sans-serif'],
          },
          boxShadow: {
            'card': '0 4px 15px rgba(0,0,0,0.08)',
            'card-hover': '0 6px 20px rgba(0,0,0,0.12)',
          }
        },
      }
    }
  </script>
  
  <!-- 自定义工具类 -->
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .card-transition {
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
      }
      .hover-lift {
        transform: translateY(-5px);
      }
      .progress-bar {
        transition: width 0.5s ease-in-out;
      }
      .alert-transition {
        transition: opacity 0.3s ease-in-out;
      }
      .page-transition {
        transition: opacity 0.3s ease-in-out;
      }

      /* ✅ 新增：用于状态和标签的样式 */
      .badge {
        @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium leading-4;
      }
      .badge-success {
        @apply bg-green-100 text-green-800;
      }
      .badge-inactive {
        @apply bg-gray-200 text-gray-800;
      }
      .badge-danger {
        @apply bg-red-100 text-red-800;
      }
      .keyword-tag {
        @apply inline-block bg-blue-100 text-blue-800 text-xs font-medium mr-2 mb-2 px-2.5 py-0.5 rounded-lg;
      }
      .action-icon-button {
        @apply text-gray-500 hover:text-primary transition-colors duration-200 text-base;
      }

      .sortable-header {
        @apply cursor-pointer select-none transition-colors duration-200 hover:bg-gray-200;
      }
      .sort-icon {
        @apply ml-2 text-gray-400;
      }
      .sort-icon.active {
        @apply text-primary;
      }
    }
  </style>
  
  <style>
    /* 全局变量 */
    :root {
      --header-height: 80px;
    }
    
    body {
      line-height: 1.6;
    }

    /* 平滑滚动 */
    html {
      scroll-behavior: smooth;
    }
    
    /* 骨架屏动画 */
    @keyframes shimmer {
      0% { background-position: -1000px 0 }
      100% { background-position: 1000px 0 }
    }
    
    .skeleton {
      background: linear-gradient(to right, #f0f0f0 4%, #f8f8f8 25%, #f0f0f0 36%);
      background-size: 1000px 100%;
      animation: shimmer 1.5s infinite linear;
    }
    
    /* 页面切换动画 */
    .page-container {
      opacity: 1;
      transition: opacity 0.3s ease-in-out;
    }
    
    .page-container.fade-out {
      opacity: 0;
    }

    /* ✅ 新增：移动端表格样式 */
    @media (max-width: 767px) {
      #detailTable thead { display: none; }
      #detailTable, #detailTable tbody, #detailTable tr, #detailTable td { display: block; width: 100%; }
      #detailTable tr { margin-bottom: 1rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; padding: 0.5rem; }
      #detailTable td {
        display: flex; justify-content: space-between; text-align: right;
        padding-left: 50%; position: relative; border: none; padding-bottom: 0.5rem;
      }
      #detailTable td:before {
        content: attr(data-label);
        position: absolute; left: 0.5rem; width: 45%; padding-right: 0.5rem;
        text-align: left; font-weight: 600; color: #374151;
      }

      /* ✅ 针对 #research-results-display 内部 Markdown 渲染的样式 */
      #research-results-display {
          /* 处理开头和结尾可能存在的多余换行符或空格 */
          white-space: pre-line; /* 保留空白符和换行符，但会合并连续的空白符 */
      }
      #research-results-display h1 { font-size: 2em; font-weight: bold; margin-top: 1em; margin-bottom: 0.5em; color: #1a202c; } /* Markdown h1 */
      
      /* ✅ 核心修改：突出二级标题样式 */
      #research-results-display h2 { 
          font-size: 1.5em; 
          font-weight: 700; /* 更粗 */
          margin-top: 1.8em; /* 顶部间距更大 */
          margin-bottom: 0.8em; 
          color: #0000ff; /* 蓝色标识 */
          border-bottom: 2px solid #0000ff; /* 蓝色下划线 */
          padding-bottom: 0.5em; 
          display: block; /* 确保占据整行 */
          width: fit-content; /* 宽度只包裹内容 */
          line-height: 1.2; /* 紧凑行高 */
      } 
      /* ✅ 核心修改：针对 h2 内部的文本加粗，并确保其颜色 */
      #research-results-display h2 strong {
          font-weight: 700; /* 确保 h2 内部的 strong 也加粗 */
          color: #0000ff; /* 确保 h2 内部的 strong 也是蓝色 */
      }

      #research-results-display h3 { font-size: 1.2em; font-weight: 600; margin-top: 1.2em; margin-bottom: 0.6em; color: #4a5568; } /* Markdown h3 */
      #research-results-display p { margin-bottom: 1em; line-height: 1.8; color: #4a5568; } /* Markdown 段落 */
      #research-results-display ul,
      #research-results-display ol { margin-bottom: 1em; padding-left: 25px; }
      #research-results-display ul { list-style-type: disc; } /* 无序列表默认圆点 */
      #research-results-display ol { list-style-type: decimal; } /* 有序列表默认数字 */
      #research-results-display li { margin-bottom: 0.5em; line-height: 1.6; color: #4a5568; }
      #research-results-display strong { font-weight: bold; color: #2d3748; } /* Markdown 粗体 */
      #research-results-display em { font-style: italic; color: #5a67d8; } /* Markdown 斜体 */
      #research-results-display a { color: #4299e1; text-decoration: underline; }
      #research-results-display code { font-family: monospace; background-color: #edf2f7; padding: 2px 4px; border-radius: 4px; }
      #research-results-display pre { background-color: #2d3748; color: #edf2f7; padding: 1em; border-radius: 8px; overflow-x: auto; font-family: monospace; white-space: pre-wrap; word-wrap: break-word; }

      /* ✅ 内部数据标记高亮样式 */
      .internal-data-highlight {
          background-color: #e6fffa; /* 浅绿色背景 */
          color: #2c7a7b; /* 深绿色文本 */
          padding: 2px 5px;
          border-radius: 4px;
          font-weight: bold;
      }
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">
  <!-- 导航栏 -->
   <header class="fixed top-0 left-0 w-full h-auto md:h-[var(--header-height)] bg-navDark border-b border-gray-800/20 flex flex-col md:flex-row items-center px-4 md:px-6 py-2 md:py-0 z-50 shadow-lg bg-[url('https://images.pexels.com/photos/3861969/pexels-photo-3861969.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=100')] bg-cover bg-center bg-blend-overlay bg-navDark/80">
    <!-- Logo -->
    <div class="w-full md:w-auto flex justify-between items-center">
      <div class="logo text-white font-bold text-2xl tracking-wide text-shadow-md">
        Deepdive Engine
      </div>
      <!-- 移动端汉堡菜单按钮 (保持不变) -->
      <button id="hamburger-menu-btn" class="text-white text-2xl p-2 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-600 md:hidden">
        <i class="fa fa-bars"></i>
      </button>
    </div>
    
    <!-- 导航菜单 -->
    <!-- ✅ 核心修正：将所有 href="javascript:void(0)" 修改为 href="#" 以解决 Google Apps Script 沙箱环境中的安全限制错误。 -->
    <nav id="main-nav" class="w-full md:w-auto hidden md:flex flex-wrap justify-center md:justify-start items-center gap-x-2 gap-y-2 mt-2 md:mt-0 md:ml-10">
      <a href="#" class="nav-link text-white px-4 py-2 rounded-lg font-medium transition-all hover:bg-white/20 text-lg flex items-center" data-page="home">
        <i class="fa fa-dashboard mr-2"></i>Overview
      </a>
      <a href="#" class="nav-link text-white px-4 py-2 rounded-lg font-medium transition-all hover:bg-white/20 text-lg flex items-center" data-page="collection">
        <i class="fa fa-database mr-2"></i>Collection
      </a>
      <a href="#" class="nav-link text-white px-4 py-2 rounded-lg font-medium transition-all hover:bg-white/20 text-lg flex items-center" data-page="insights">
        <i class="fa fa-lightbulb-o mr-2"></i>Analyzation
      </a>
      <a href="#" class="nav-link text-white px-4 py-2 rounded-lg font-medium transition-all hover:bg-white/20 text-lg flex items-center" data-page="actions">
        <i class="fa fa-cogs mr-2"></i>DeepResearch
      </a>
      <a href="#" class="nav-link text-white px-4 py-2 rounded-lg font-medium transition-all hover:bg-white/20 text-lg flex items-center" data-page="reports">
        <i class="fa fa-file-text-o mr-2"></i>Reports
      </a>
      <a href="#" class="nav-link text-white px-4 py-2 rounded-lg font-medium transition-all hover:bg-white/20 text-lg flex items-center" data-page="system">
        <i class="fa fa-gears mr-2"></i>System
      </a>
    </nav>
  </header>

  <!-- 主内容区域 -->
  <main id="main-content" class="pt-[var(--header-height)] px-4 md:px-6 py-6 max-w-7xl mx-auto">
    <!-- 初始加载动画 -->
    <div id="loader" class="flex flex-col justify-center items-center h-[calc(100vh-var(--header-height)-60px)] text-gray-500 text-lg">
      <div class="spinner border-4 border-gray-200 border-l-primary w-10 h-10 rounded-full animate-spin mb-4"></div>
      <p>正在初始化...</p>
    </div>

    <!-- 主仪表板内容 -->
    <!-- Content from pages/index.html will be loaded here by router.js -->
    <div id="page-home" class="page-container">
      <div class="kpi-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-6 mb-8">
        <!-- 原始数据统计卡片 -->
        <div class="kpi-card bg-white rounded-xl shadow-card p-6 col-span-1 md:col-span-2 lg:col-span-3 group1 bg-group1 transition-all hover:shadow-card-hover" data-type="academicPapers">
          <div class="kpi-card-header flex items-center mb-4">
            <span class="kpi-card-icon text-2xl text-primary mr-3"><i class="fa fa-bar-chart"></i></span>
            <span class="kpi-card-title font-semibold text-lg">原始数据统计</span>
          </div>
          <div class="kpi-main-stats flex items-baseline justify-between mb-4">
            <span class="kpi-value text-3xl font-bold text-primary skeleton" id="rawDataTotal">--</span>
            <span class="kpi-sub-label text-gray-500">总量</span>
            <span class="kpi-today-update bg-gray-100 text-gray-600 px-3 py-1 rounded-md text-sm skeleton" id="rawDataTodayUpdate">近7日采集: --</span>
          </div>
          <div class="kpi-categories grid grid-cols-2 sm:grid-cols-3 gap-2 pt-4 border-t border-gray-200" id="rawDataCategories">
            <!-- 分类数据将由JS填充 -->
            <div class="kpi-category-item bg-gray-100 px-3 py-1 rounded-md text-sm hover:bg-gray-200 transition-colors">
              <span class="kpi-category-value font-semibold skeleton">--</span>论文
            </div>
            <div class="kpi-category-item bg-gray-100 px-3 py-1 rounded-md text-sm hover:bg-gray-200 transition-colors">
              <span class="kpi-category-value font-semibold skeleton">--</span>新闻
            </div>
            <div class="kpi-category-item bg-gray-100 px-3 py-1 rounded-md text-sm hover:bg-gray-200 transition-colors">
              <span class="kpi-category-value font-semibold skeleton">--</span>会议
            </div>
            <div class="kpi-category-item bg-gray-100 px-3 py-1 rounded-md text-sm hover:bg-gray-200 transition-colors">
              <span class="kpi-category-value font-semibold skeleton">--</span>专利
            </div>
            <div class="kpi-category-item bg-gray-100 px-3 py-1 rounded-md text-sm hover:bg-gray-200 transition-colors">
              <span class="kpi-category-value font-semibold skeleton">--</span>开源
            </div>
            <div class="kpi-category-item bg-gray-100 px-3 py-1 rounded-md text-sm hover:bg-gray-200 transition-colors">
              <span class="kpi-category-value font-semibold skeleton">--</span>竞情
            </div>
          </div>
        </div>

        <!-- 洞察线索统计卡片 -->
        <div class="kpi-card bg-white rounded-xl shadow-card p-6 col-span-1 md:col-span-2 lg:col-span-3 group1 bg-group1 transition-all hover:shadow-card-hover">
          <div class="kpi-card-header flex items-center mb-4">
            <span class="kpi-card-icon text-2xl text-primary mr-3"><i class="fa fa-lightbulb-o"></i></span>
            <span class="kpi-card-title font-semibold text-lg">洞察线索统计</span>
          </div>
          <div class="kpi-main-stats flex items-baseline justify-between mb-4">
            <span class="kpi-value text-3xl font-bold text-primary skeleton" id="insightLeadTotal">--</span>
            <span class="kpi-sub-label text-gray-500">总量</span>
            <span class="kpi-today-update bg-gray-100 text-gray-600 px-3 py-1 rounded-md text-sm skeleton" id="insightLeadTodayUpdate">近7日采集: --</span>
          </div>
          <div class="kpi-categories grid grid-cols-2 sm:grid-cols-4 gap-2 pt-4 border-t border-gray-200" id="insightLeadCategories">
            <!-- 分类数据将由JS填充 -->
            <div class="kpi-category-item bg-gray-100 px-3 py-1 rounded-md text-sm hover:bg-gray-200 transition-colors">
              <span class="kpi-category-value font-semibold skeleton">--</span>待处理
            </div>
            <div class="kpi-category-item bg-gray-100 px-3 py-1 rounded-md text-sm hover:bg-gray-200 transition-colors">
              <span class="kpi-category-value font-semibold skeleton">--</span>处理中
            </div>
            <div class="kpi-category-item bg-gray-100 px-3 py-1 rounded-md text-sm hover:bg-gray-200 transition-colors">
              <span class="kpi-category-value font-semibold skeleton">--</span>已完成
            </div>
            <div class="kpi-category-item bg-gray-100 px-3 py-1 rounded-md text-sm hover:bg-gray-200 transition-colors">
              <span class="kpi-category-value font-semibold skeleton">--</span>已发布
            </div>
          </div>
        </div>

        <!-- 细分技术领域卡片 -->
        <div class="kpi-card bg-white rounded-xl shadow-card p-6 col-span-1 md:col-span-2 lg:col-span-2 group2 bg-group2 transition-all hover:shadow-card-hover cursor-pointer clickable-kpi" data-type="techDomain">
          <div class="kpi-card-header flex items-center mb-4">
            <span class="kpi-card-icon text-2xl text-primary mr-3"><i class="fa fa-flask"></i></span>
            <span class="kpi-card-title font-semibold text-lg">细分技术领域</span>
          </div>
          <div class="kpi-main-stats flex items-baseline justify-between mb-4">
            <span class="kpi-value text-3xl font-bold text-primary skeleton" id="techDomainTotal">--</span>
            <span class="kpi-sub-label text-gray-500">总数</span>
            <span class="kpi-today-update bg-gray-100 text-gray-600 px-3 py-1 rounded-md text-sm skeleton" id="techDomainActive">活跃: --</span>
          </div>
          <div class="kpi-footer text-gray-500 text-sm flex justify-between items-center">
            <span>点击查看详情</span>
            <i class="fa fa-chevron-right text-xs"></i>
          </div>
        </div>

        <!-- 业界关键标杆卡片 -->
        <div class="kpi-card bg-white rounded-xl shadow-card p-6 col-span-1 md:col-span-2 lg:col-span-2 group2 bg-group2 transition-all hover:shadow-card-hover cursor-pointer clickable-kpi" data-type="industryBenchmark">
          <div class="kpi-card-header flex items-center mb-4">
            <span class="kpi-card-icon text-2xl text-primary mr-3"><i class="fa fa-building"></i></span>
            <span class="kpi-card-title font-semibold text-lg">业界关键标杆</span>
          </div>
          <div class="kpi-main-stats flex items-baseline justify-between mb-4">
            <span class="kpi-value text-3xl font-bold text-primary skeleton" id="industryBenchmarkTotal">--</span>
            <span class="kpi-sub-label text-gray-500">总数</span>
            <span class="kpi-today-update bg-gray-100 text-gray-600 px-3 py-1 rounded-md text-sm skeleton" id="industryBenchmarkFocus">重点: --</span>
          </div>
          <div class="kpi-footer text-gray-500 text-sm flex justify-between items-center">
            <span>点击查看详情</span>
            <i class="fa fa-chevron-right text-xs"></i>
          </div>
        </div>

        <!-- 产业学术顶会卡片 -->
        <div class="kpi-card bg-white rounded-xl shadow-card p-6 col-span-1 md:col-span-2 lg:col-span-2 group2 bg-group2 transition-all hover:shadow-card-hover cursor-pointer clickable-kpi" data-type="conference">
          <div class="kpi-card-header flex items-center mb-4">
            <span class="kpi-card-icon text-2xl text-primary mr-3"><i class="fa fa-calendar"></i></span>
            <span class="kpi-card-title font-semibold text-lg">产业学术顶会</span>
          </div>
          <div class="kpi-main-stats flex items-baseline justify-between mb-4">
            <span class="kpi-value text-3xl font-bold text-primary skeleton" id="conferenceTotal">--</span>
            <span class="kpi-sub-label text-gray-500">总数</span>
            <span class="kpi-today-update bg-gray-100 text-gray-600 px-3 py-1 rounded-md text-sm skeleton" id="conferenceMonitoring">关注中: --</span>
          </div>
          <div class="kpi-footer text-gray-500 text-sm flex justify-between items-center">
            <span>点击查看详情</span>
            <i class="fa fa-chevron-right text-xs"></i>
          </div>
        </div>

        <!-- ✅ 新增: 全新的数据流转化漏斗组件 -->
        <div class="col-span-1 md:col-span-6 lg:col-span-6 bg-white rounded-xl shadow-card p-6">
          <h3 class="text-xl font-semibold mb-2 flex items-center">
            <i class="fa fa-sitemap text-primary mr-3" style="transform: rotate(90deg);"></i>
            技术洞察转化漏斗
          </h3>
          
          <div class="w-full">
            <div class="w-11/12 mx-auto">
              <!-- 桑基图组件的完整包裹器 -->
              <div id="sankey-component-wrapper">
                <!-- 顶部标签容器 -->
                <div id="sankey-labels-top" class="relative h-12">
                    <!-- JS 将在此处动态生成标签 -->
                </div>

                <!-- ✅ 核心修改: 移除内联的 background-color 样式 -->
                <div id="sankey-chart-container" 
                     class="h-48 w-full relative rounded-lg">
                    <!-- ECharts 画布将渲染在此容器中 -->
                </div>

                <!-- 底部标签容器 -->
                <div id="sankey-labels-bottom" class="relative h-6 mt-1">
                    <!-- JS 将在此处动态生成 "被过滤/归档" 标签 -->
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- 新增组件结束 -->

        <!-- 系统状态卡片 -->
        <div class="kpi-card bg-white rounded-xl shadow-card p-6 col-span-1 md:col-span-3 lg:col-span-3 group3 bg-group3 transition-all hover:shadow-card-hover">
          <div class="kpi-card-header flex items-center mb-4">
            <span class="kpi-card-icon text-2xl text-primary mr-3"><i class="fa fa-cog"></i></span>
            <span class="kpi-card-title font-semibold text-lg">系统状态</span>
          </div>
          
          <div class="space-y-4">
            <div class="status-item flex items-center">
              <span class="status-label font-medium w-24">整体健康度</span>
              <div class="progress-bar-container flex-grow bg-gray-200 rounded-full h-2.5 mx-2">
                <div class="progress-bar bg-primary rounded-full h-full" id="overallHealthBar" style="width: 0%"></div>
              </div>
              <span class="status-percentage font-medium text-gray-600 w-12 skeleton" id="overallHealthPct">--%</span>
            </div>
            
            <div class="status-item flex items-center">
              <span class="status-label font-medium w-24">工作流状态</span>
              <div class="progress-bar-container flex-grow bg-gray-200 rounded-full h-2.5 mx-2">
                <div class="progress-bar bg-primary rounded-full h-full" id="workflowHealthBar" style="width: 0%"></div>
              </div>
              <span class="status-percentage font-medium text-gray-600 w-12 skeleton" id="workflowHealthPct">--%</span>
            </div>
            
            <div class="status-item flex items-center">
              <span class="status-label font-medium w-24">数据质量</span>
              <div class="progress-bar-container flex-grow bg-gray-200 rounded-full h-2.5 mx-2">
                <div class="progress-bar bg-primary rounded-full h-full" id="dataQualityBar" style="width: 0%"></div>
              </div>
              <span class="status-percentage font-medium text-gray-600 w-12 skeleton" id="dataQualityPct">--%</span>
            </div>
          </div>
        </div>

        <!-- 系统警报卡片 -->
        <div class="kpi-card bg-white rounded-xl shadow-card p-6 col-span-1 md:col-span-3 lg:col-span-3 group3 bg-group3 transition-all hover:shadow-card-hover">
          <div class="kpi-card-header flex items-center mb-4">
            <span class="kpi-card-icon text-2xl text-primary mr-3"><i class="fa fa-bell"></i></span>
            <span class="kpi-card-title font-semibold text-lg">系统警报</span>
          </div>
          
          <div id="systemAlertsList" class="space-y-3">
            <div class="alert-item bg-blue-50 border-l-4 border-blue-400 p-4 rounded-md shadow-sm">
              <div class="alert-title font-medium text-blue-800">系统健康度良好</div>
              <p class="text-blue-700 text-sm">当前系统运行正常，无重要警报。</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 数据采集页面 -->
    <!-- ================================================================== -->
    <!--  ✅ page-collection 的最终完整代码块 (包含所有子容器和结构)   -->
    <!-- ================================================================== -->
    <div id="page-collection" class="page-container hidden">
      <div class="p-6 bg-white rounded-xl shadow-lg">       
        <!-- 标签页导航 -->
        <div class="border-b border-gray-200">
          <nav id="collection-tabs" class="-mb-px flex space-x-8" aria-label="Tabs">
            <a href="#" class="collection-tab whitespace-nowrap py-4 px-1 border-b-2 font-semibold text-lg" data-tab="overview">
              数据源概览
            </a>
            <a href="#" class="collection-tab whitespace-nowrap py-4 px-1 border-b-2 font-semibold text-lg" data-tab="workflows">
              工作流中心
            </a>
          </nav>
        </div>

        <!-- 标签页内容容器 -->
        <div class="mt-6">
          <!-- “数据源概览”的完整内容 -->
          <div id="tab-content-overview" class="tab-content">
            <!-- Section 1: 技术数据采集 -->
            <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 mb-8">
              <div class="flex items-center mb-6 border-b pb-4">
                <i class="fa fa-cogs text-xl text-primary mr-3"></i>
                <h3 class="text-xl font-bold text-gray-800">技术数据采集</h3>
                <span class="ml-4 text-sm text-gray-500">关注全球技术动态，捕捉前沿技术信号</span>
              </div>
              <div id="tech-data-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- JS会填充技术数据源卡片 -->
                <div class="skeleton h-56 rounded-lg"></div>
                <div class="skeleton h-56 rounded-lg"></div>
                <div class="skeleton h-56 rounded-lg"></div>
                <div class="skeleton h-56 rounded-lg"></div>
              </div>
            </div>

            <!-- Section 2: 标杆数据采集 -->
            <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 mb-8">
              <div class="flex items-center mb-6 border-b pb-4">
                <i class="fa fa-flag-checkered text-xl text-primary mr-3"></i>
                <h3 class="text-xl font-bold text-gray-800">标杆数据采集</h3>
                <span class="ml-4 text-sm text-gray-500">追踪标杆企业动态，洞察产业发展趋势</span>
              </div>
              <div class="bg-white p-4 rounded-lg border border-gray-200 mb-4 flex items-center justify-between shadow-sm">
                <div class="flex items-center gap-4">
                  <label for="company-select" class="font-medium text-gray-700">选择企业:</label>
                  <select id="company-select" class="w-64 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
                    <option value="">所有企业</option>
                  </select>
                  <button id="filter-btn" class="px-5 py-2 bg-primary text-white font-semibold rounded-md hover:bg-blue-700 transition-colors shadow">筛选</button>
                  <button id="clear-filter-btn" class="px-5 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors">清除筛选</button>
                </div>
              </div>
              <p id="filter-status-text" class="text-sm text-gray-500 mb-6">显示所有企业的标杆企业数据</p>
              <div id="benchmark-data-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- JS会填充标杆数据源卡片 -->
                <div class="skeleton h-56 rounded-lg"></div>
                <div class="skeleton h-56 rounded-lg"></div>
                <div class="skeleton h-56 rounded-lg"></div>
                <div class="skeleton h-56 rounded-lg"></div>
              </div>
            </div>
            
            <!-- Section 3: 采集统计 -->
            <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 mb-8">
              <div class="flex items-center mb-6 border-b pb-4">
                <i class="fa fa-line-chart text-xl text-primary mr-3"></i>
                <h3 class="text-xl font-bold text-gray-800">采集统计</h3>
              </div>
              <div id="collection-stats-grid" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="skeleton h-24 rounded-lg"></div>
                <div class="skeleton h-24 rounded-lg"></div>
                <div class="skeleton h-24 rounded-lg"></div>
              </div>
            </div>

            <!-- Section 4: 最近采集历史 -->
            <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
              <div class="flex items-center mb-6 border-b pb-4">
                <i class="fa fa-history text-xl text-primary mr-3"></i>
                <h3 class="text-xl font-bold text-gray-800">最近采集历史</h3>
              </div>
              <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                  <thead class="bg-gray-100">
                    <tr>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">任务名称</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">开始时间</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">结束时间</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                      <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                    </tr>
                  </thead>
                  <tbody class="bg-white divide-y divide-gray-200">
                    <tr><td colspan="5" class="text-center py-4 text-gray-500">正在加载历史记录...</td></tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- “工作流中心”的完整内容 -->
          <div id="tab-content-workflows" class="tab-content hidden">
            <!-- 页面内导航栏 -->
            <div id="workbench-nav" class="sticky top-[var(--header-height)] bg-white/80 backdrop-blur-sm z-30 py-3 mb-6 rounded-lg shadow-sm">
              <div class="max-w-7xl mx-auto px-2">
                <nav class="flex justify-around items-center space-x-2 text-sm md:text-base">
                  <a href="#wf-section-1" class="workbench-nav-link px-3 py-2 font-semibold text-gray-600 hover:bg-gray-200 hover:text-primary rounded-md transition-all">第一层: 采集</a>
                  <a href="#wf-section-2" class="workbench-nav-link px-3 py-2 font-semibold text-gray-600 hover:bg-gray-200 hover:text-primary rounded-md transition-all">第二层: 识别</a>
                  <a href="#wf-section-3" class="workbench-nav-link px-3 py-2 font-semibold text-gray-600 hover:bg-gray-200 hover:text-primary rounded-md transition-all">第三层: 验证</a>
                  <a href="#wf-section-4" class="workbench-nav-link px-3 py-2 font-semibold text-gray-600 hover:bg-gray-200 hover:text-primary rounded-md transition-all">第四层: 分析</a>
                  <a href="#wf-section-5" class="workbench-nav-link px-3 py-2 font-semibold text-gray-600 hover:bg-gray-200 hover:text-primary rounded-md transition-all">第五层: 决策</a>
                  <a href="#wf-section-6" class="workbench-nav-link px-3 py-2 font-semibold text-gray-600 hover:bg-gray-200 hover:text-primary rounded-md transition-all">第六层: 监控</a>
                </nav>
              </div>
            </div>
            <!-- 各个工作流层级的容器 -->
            <div id="wf-section-1" class="mb-8">
              <h3 class="text-xl font-semibold mb-4 text-gray-700 border-b pb-2">第一层：精准数据采集 (并行)</h3>
              <div id="wf-layer-1" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
            <div id="wf-section-2" class="mb-8">
              <h3 class="text-xl font-semibold mb-4 text-gray-700 border-b pb-2">第二层：分表信号识别 (串行)</h3>
              <div id="wf-layer-2" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
            <div id="wf-section-3" class="mb-8">
              <h3 class="text-xl font-semibold mb-4 text-gray-700 border-b pb-2">第三层：统一证据验证 (统一处理)</h3>
              <div id="wf-layer-3" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
            <div id="wf-section-4" class="mb-8">
              <h3 class="text-xl font-semibold mb-4 text-gray-700 border-b pb-2">第四层：深度分析 (并行)</h3>
              <div id="wf-layer-4" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
            <div id="wf-section-5" class="mb-8">
              <h3 class="text-xl font-semibold mb-4 text-gray-700 border-b pb-2">第五层：决策支撑 (串行)</h3>
              <div id="wf-layer-5" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
            <div id="wf-section-6" class="mb-8">
              <h3 class="text-xl font-semibold mb-4 text-gray-700 border-b pb-2">第六层：监控与维护 (独立运行)</h3>
              <div id="wf-layer-6" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 技术洞察页面 -->
    <div id="page-insights" class="page-container hidden">
      <div class="p-6 bg-white rounded-xl shadow-lg">
        <!-- 标签页导航 -->
        <div class="border-b border-gray-200 mb-6">
          <nav id="analyzation-tabs" class="-mb-px flex space-x-8" aria-label="Tabs">
            <a href="#" class="analyzation-tab whitespace-nowrap py-4 px-1 border-b-2 font-semibold text-lg" data-tab="trends">
              <i class="fa fa-area-chart mr-2"></i>关键技术线索
            </a>
            <a href="#" class="analyzation-tab whitespace-nowrap py-4 px-1 border-b-2 font-semibold text-lg" data-tab="hype-cycle">
              <i class="fa fa-line-chart mr-2"></i>技术成熟度
            </a>
            <!-- ✅ 恢复：技术知识图谱标签页 -->
            <a href="#" class="analyzation-tab whitespace-nowrap py-4 px-1 border-b-2 font-semibold text-lg" data-tab="knowledge-graph">
              <i class="fa fa-sitemap mr-2"></i>技术知识图谱
            </a>
            <!-- ✅ 新增：专家网络标签页 -->
            <a href="#" class="analyzation-tab whitespace-nowrap py-4 px-1 border-b-2 font-semibold text-lg" data-tab="expert-network">
              <i class="fa fa-users mr-2"></i>领域专家网络
            </a>
          </nav>
        </div>

        <!-- 标签页内容区域 -->

        <!-- "趋势与关键词" 内容 -->
        <div id="tab-content-trends" class="analyzation-tab-content">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
              <h3 class="text-xl font-semibold mb-4 flex items-center"><i class="fa fa-area-chart text-primary mr-2"></i>趋势分析</h3>
              <div id="trend-chart-container" class="h-80 bg-white p-4 rounded-lg shadow-sm border border-gray-200"></div>
            </div>
            <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
              <h3 class="text-xl font-semibold mb-4 flex items-center"><i class="fa fa-tags text-primary mr-2"></i>热点关键词</h3>
              <div id="keyword-cloud-container" class="h-80 bg-white p-4 rounded-lg shadow-sm border border-gray-200"></div>
            </div>
          </div>
          <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 mb-8">
            <h3 class="text-xl font-semibold mb-4 flex items-center"><i class="fa fa-lightbulb-o text-primary mr-2"></i>最新洞察线索</h3>
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-200 table-fixed">
                <thead>
                  <tr>
                    <th class="w-2/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">标题</th>
                    <th class="w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">来源</th>
                    <th class="w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">日期</th>
                    <th class="w-1/5 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                    <th class="w-auto px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                  </tr>
                </thead>
                <tbody><!-- JS will populate this --></tbody>
              </table>
            </div>
            <!-- ✅ 新增：为最新洞察线索添加分页控件 -->
            <div class="flex justify-between items-center mt-4">
                <button id="insightsPrevPageBtn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 disabled:opacity-50">上一页</button>
                <span id="insightsPaginationInfo" class="text-sm text-gray-600"></span>
                <button id="insightsNextPageBtn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 disabled:opacity-50">下一页</button>
            </div>
          </div>
        </div>

        <!-- "技术成熟度" 内容 -->
        <div id="tab-content-hype-cycle" class="analyzation-tab-content hidden">
          <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
            <h3 class="text-xl font-semibold mb-4 flex items-center"><i class="fa fa-line-chart text-primary mr-2"></i>技术成熟度曲线</h3>
            <div id="hype-cycle-chart-container" class="h-[600px] bg-white p-4 rounded-lg shadow-sm border border-gray-200"></div>
          </div>
        </div>

        <!-- ✅ 恢复："技术知识图谱" 内容 -->
        <div id="tab-content-knowledge-graph" class="analyzation-tab-content hidden">
          <div class="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200" style="min-height: 600px;">
            <div id="knowledge-graph-container" style="width: 100%; height: 600px;"></div>
          </div>
        </div>

        <!-- ✅ 新增："专家网络" 内容 -->
        <div id="tab-content-expert-network" class="analyzation-tab-content hidden">
          <div class="flex flex-col md:flex-row gap-6">
            <div class="w-full md:w-3/4 bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200" style="min-height: 600px;">
              <div id="expert-network-container" style="width: 100%; height: 100%;">
                <div class="flex items-center justify-center h-full text-gray-400">
                  <i class="fa fa-spinner fa-spin text-4xl mr-3"></i>
                  <span>正在加载专家网络图谱...</span>
                </div>
              </div>
            </div>
            <div class="w-full md:w-1/4 bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200">
              <h3 class="text-lg font-semibold mb-3">节点详情</h3>
              <div id="expert-node-details" class="text-sm text-gray-700 space-y-2">
                <p>点击图谱中的节点查看详情。</p>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

        <!-- 研究中心页面 (原决策行动中心) -->
    <div id="page-actions" class="page-container hidden">
      <div class="p-6 bg-white rounded-xl shadow-lg">
        <h2 class="text-2xl font-bold mb-6 text-gray-800">深度研究中心</h2>
        
        <div class="space-y-6">
          <!-- 搜索输入区 -->
          <!-- ✅ 核心修改：调整父容器的对齐方式，并为textarea设置固定高度 -->
          <div class="flex flex-col md:flex-row gap-4 items-center"> <!-- items-center 让子元素垂直居中对齐 -->
            <div class="flex-grow w-full">
              <label for="research-query" class="block text-sm font-medium text-gray-700 mb-1">输入您的研究查询：</label>
              <!-- ✅ 核心修改：调整 textarea 的 padding 和 line-height，使其与按钮的视觉高度更匹配 -->
              <textarea id="research-query" 
                        class="w-full border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-primary focus:border-primary placeholder-gray-400 text-base" 
                        placeholder="例如：AI在ICT领域的最新突破和商业化前景..." 
                        style="min-height: 42px; padding: 0.5rem 1rem; line-height: 1.5; resize: vertical; box-sizing: border-box;"></textarea> <!-- padding和line-height匹配按钮，box-sizing确保高度计算一致 -->
            </div>
            <button id="perform-research-btn" 
                    class="px-6 py-2 bg-primary text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors shadow flex-shrink-0 flex items-center justify-center min-w-[120px]">
              <i class="fa fa-flask mr-2"></i>开始深度研究
            </button>
          </div>

          <!-- 研究结果显示区 -->
          <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 min-h-[400px] relative">
            <h3 class="text-xl font-semibold mb-4 text-gray-800 flex items-center">
              <i class="fa fa-lightbulb-o text-primary mr-2"></i>研究报告
            </h3>
            <div id="research-results-display" class="prose max-w-none" style="min-height: 300px;">
              <p class="text-gray-500">在此输入查询并点击“开始深度研究”，AI将为您生成专业的研究报告。</p>
            </div>
            <!-- 加载指示器 -->
            <div id="research-loading-spinner" class="absolute inset-0 bg-white bg-opacity-80 flex items-center justify-center hidden">
                <i class="fa fa-spinner fa-spin text-4xl text-primary"></i>
                <span class="ml-3 text-primary text-lg">AI正在进行深度研究，请稍候...</span>
            </div>
          </div>
        </div>
      </div>
    </div>


    <!-- 报告中心页面 -->
    <div id="page-reports" class="page-container hidden">
      <div class="p-6 bg-white rounded-xl shadow-lg">
        <h2 class="text-2xl font-bold mb-6 text-gray-800">报告中心</h2>
        
        <!-- 报告类型卡片（这部分保持不变） -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 flex flex-col items-center justify-center text-center cursor-pointer hover:bg-gray-100 transition-colors">
            <div class="text-4xl text-primary mb-3"><i class="fa fa-file-text-o"></i></div>
            <h3 class="text-lg font-semibold mb-1">季度技术趋势报告</h3>
            <p class="text-sm text-gray-500 mb-3">分析本季度主要技术趋势和发展方向</p>
            <span class="text-xs text-gray-400">最近更新: 2025-06-15</span>
          </div>
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 flex flex-col items-center justify-center text-center cursor-pointer hover:bg-gray-100 transition-colors">
            <div class="text-4xl text-primary mb-3"><i class="fa fa-bar-chart"></i></div>
            <h3 class="text-lg font-semibold mb-1">竞争技术分析</h3>
            <p class="text-sm text-gray-500 mb-3">对比主要竞争对手的技术布局和优势</p>
            <span class="text-xs text-gray-400">最近更新: 2025-05-30</span>
          </div>
          <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 flex flex-col items-center justify-center text-center cursor-pointer hover:bg-gray-100 transition-colors">
            <div class="text-4xl text-primary mb-3"><i class="fa fa-lightbulb-o"></i></div>
            <h3 class="text-lg font-semibold mb-1">技术创新洞察</h3>
            <p class="text-sm text-gray-500 mb-3">识别潜在的技术创新机会和突破点</p>
            <span class="text-xs text-gray-400">最近更新: 2025-06-20</span>
          </div>
        </div>
        
        <!-- **新增：自动化报告任务状态区域** -->
        <div id="scheduledReportsStatus" class="bg-gray-50 p-6 rounded-lg border border-gray-200 mb-8">
          <!-- 内容将由JS动态填充 -->
          <h3 class="text-xl font-semibold mb-4 flex items-center">
            <i class="fa fa-clock-o text-primary mr-2"></i>自动化报告任务状态
          </h3>
          <div class="p-4 text-gray-500">正在加载自动化任务状态...</div>
        </div>
        <!-- **新增区域结束** -->

        <!-- 报告历史记录 -->
        <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 mb-8">
          <h3 class="text-xl font-semibold mb-4 flex items-center">
            <i class="fa fa-history text-primary mr-2"></i>报告历史记录
          </h3>
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-100">
                <tr>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">报告名称</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">报告类型</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">生成日期</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">生成者</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                </tr>
              </thead>
              <tbody id="reportHistoryTable" class="bg-white divide-y divide-gray-200">
                <!-- 报告历史记录将由JS填充 -->
                <tr><td colspan="6" class="text-center py-4 text-gray-500">正在加载报告历史...</td></tr>
              </tbody>
            </table>
          </div>
          <!-- **新增：报告历史记录分页控件** -->
          <div class="flex justify-between items-center mt-4">
            <button id="reportsHistoryPrevPageBtn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 disabled:opacity-50">上一页</button>
            <span id="reportsHistoryPaginationInfo" class="text-sm text-gray-600"></span>
            <button id="reportsHistoryNextPageBtn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 disabled:opacity-50">下一页</button>
          </div>
          <!-- **新增：报告历史记录分页控件 结束** -->
        </div>
        
        <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 hidden mb-8" >
          <h3 class="text-xl font-semibold mb-4 flex items-center hidden">
            <i class="fa fa-plus-circle text-primary mr-2"></i>创建新报告
          </h3>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">报告类型</label>
                <select name="report-type-select" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
                  <option value="Daily">日报</option>
                  <option value="Weekly">周报</option>
                  <option value="Monthly">月报</option>
                  <option value="Quarterly">季度报告</option>
                  <option value="Annual">年报</option>
                  <option value="Custom">自定义报告</option>
                </select>
              </div>
              
              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">报告标题</label>
                <input type="text" name="report-title-input" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary" placeholder="输入报告标题">
              </div>
              
              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">报告周期</label>
                <div class="flex items-center space-x-4">
                  <div class="flex items-center">
                    <input type="radio" id="weekly" name="report-period" value="weekly" class="h-4 w-4 text-primary focus:ring-primary border-gray-300" checked>
                    <label for="weekly" class="ml-2 block text-sm text-gray-700">周度</label>
                  </div>
                  <div class="flex items-center">
                    <input type="radio" id="monthly" name="report-period" value="monthly" class="h-4 w-4 text-primary focus:ring-primary border-gray-300">
                    <label for="monthly" class="ml-2 block text-sm text-gray-700">月度</label>
                  </div>
                  <div class="flex items-center">
                    <input type="radio" id="quarterly" name="report-period" value="quarterly" class="h-4 w-4 text-primary focus:ring-primary border-gray-300">
                    <label for="quarterly" class="ml-2 block text-sm text-gray-700">季度</label>
                  </div>
                  <div class="flex items-center">
                    <input type="radio" id="annual" name="report-period" value="annual" class="h-4 w-4 text-primary focus:ring-primary border-gray-300">
                    <label for="annual" class="ml-2 block text-sm text-gray-700">年度</label>
                  </div>
                  <div class="flex items-center">
                    <input type="radio" id="custom" name="report-period" value="custom" class="h-4 w-4 text-primary focus:ring-primary border-gray-300">
                    <label for="custom" class="ml-2 block text-sm text-gray-700">自定义</label>
                  </div>
                </div>
                <!-- 自定义日期范围 -->
                <div id="customDateRange" class="flex items-center space-x-2 mt-2 hidden">
                  <input type="date" id="startDate" class="w-1/2 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
                  <span>至</span>
                  <input type="date" id="endDate" class="w-1/2 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
                </div>
              </div>
              
              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">覆盖技术领域</label>
                <div id="techAreaCheckboxesContainer" class="grid grid-cols-1 gap-2">
                  <!-- 技术领域复选框将由JavaScript动态填充 -->
                </div>  
              
                <div class="flex items-center">
                  <input type="checkbox" id="all-tech-areas" name="tech-area-checkbox" value="all" class="h-4 w-4 text-primary focus:ring-primary border-gray-300">
                  <label for="all-tech-areas" class="ml-2 block text-sm text-gray-700">全选</label>
                </div>
              </div>
            </div>
            
            <div>
              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">目标受众</label>
                <select name="target-audience-select" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
                  <option value="技术团队">技术团队</option>
                  <option value="管理层">管理层</option>
                  <option value="产品团队">产品团队</option>
                  <option value="市场团队">市场团队</option>
                  <option value="多部门共享">多部门共享</option>
                </select>
              </div>
              
              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">报告负责人</label>
                <input type="text" name="report-owner-input" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary" placeholder="输入负责人姓名">
              </div>
              
              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">接收者邮箱 (可选，用于邮件分发)</label>
                <input type="email" id="recipient-email-input" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary" placeholder="输入邮箱地址">
              </div>

              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">预计完成日期</label>
                <input type="date" name="expected-completion-date" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
              </div>
              
              <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">报告摘要</label>
                <textarea name="report-summary-textarea" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary" rows="4" placeholder="简要描述报告内容和目的"></textarea>
              </div>
            </div>
          </div>
          
          <div class="mt-6 flex justify-end">
            <button class="mr-3 px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
              保存为草稿
            </button>
            <button id="generateReportBtn" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary">
              生成报告
            </button>
          </div>
        </div>
      </div>
    </div>

     <!-- ✅ 新增：系统管理页面容器 -->
    <div id="page-system" class="page-container hidden">
      <div class="p-6 bg-white rounded-xl shadow-lg">
        <!-- 二级导航栏 -->
        <div class="border-b border-gray-200 mb-6">
          <nav id="system-sub-tabs" class="-mb-px flex space-x-8" aria-label="System Sub-Tabs">
            <a href="#" class="system-sub-tab whitespace-nowrap py-4 px-1 border-b-2 font-semibold text-lg" data-sub-tab="registries">数据源管理</a>
            <a href="#" class="system-sub-tab whitespace-nowrap py-4 px-1 border-b-2 font-semibold text-lg" data-sub-tab="users-mgmt">用户管理</a>
            <a href="#" class="system-sub-tab whitespace-nowrap py-4 px-1 border-b-2 font-semibold text-lg" data-sub-tab="reports-mgmt">报告管理</a>
          </nav>
        </div>

        <!-- 标签页内容容器 -->
        <div id="system-tab-content-settings" class="system-sub-tab-content">
          <h3 class="text-xl font-semibold mb-4">系统配置</h3>
          <!-- 现有系统配置表单和内容 -->
        </div>

        <div id="system-tab-content-registries" class="system-sub-tab-content hidden">
          <!-- 注册表子导航 -->
          <div class="border-b border-gray-200 mb-4">
            <nav id="registry-tabs" class="-mb-px flex space-x-4" aria-label="Registry Tabs">
              <a href="#" class="registry-tab whitespace-nowrap py-2 px-1 border-b-2 font-medium text-base" data-registry="TECH_REGISTRY">技术领域</a>
              <a href="#" class="registry-tab whitespace-nowrap py-2 px-1 border-b-2 font-medium text-base" data-registry="COMPETITOR_REGISTRY">业界标杆</a>
              <a href="#" class="registry-tab whitespace-nowrap py-2 px-1 border-b-2 font-medium text-base" data-registry="CONFERENCE_REGISTRY">学术顶会</a>
              <a href="#" class="registry-tab whitespace-nowrap py-2 px-1 border-b-2 font-medium text-base" data-registry="EXTERNAL_DATA_SOURCES">外部数据源</a>
            </nav>
          </div>

          <!-- 具体注册表内容将在此处动态加载 -->
          <div id="current-registry-content" class="mt-4">
            <!-- 这个 div 会被 JavaScript 动态替换和填充，例如： -->
            <!--
            <div id="registry-TECH_REGISTRY" class="registry-content">
              <div class="flex justify-between items-center mb-4">
                <h4 class="text-lg font-semibold">技术领域列表</h4>
                <button class="px-4 py-2 bg-primary text-white rounded-md hover:bg-blue-700" data-action="add-tech-registry">添加新领域</button>
              </div>
              <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>技术名称</th>
                      <th>类别</th>
                      <th>监控状态</th>
                      <th>操作</th>
                    </tr>
                  </thead>
                  <tbody id="tech-registry-tbody">
                    <tr><td colspan="5" class="text-center py-4 text-gray-500">正在加载数据...</td></tr>
                  </tbody>
                </table>
              </div>
            </div>
            -->
          </div>
        </div>

        <div id="system-tab-content-users-mgmt" class="system-sub-tab-content hidden">
          <h3 class="text-xl font-semibold mb-4">用户管理</h3>
          <!-- 用户列表、角色管理等 -->
        </div>

        <div id="system-tab-content-reports-mgmt" class="system-sub-tab-content hidden">
          <h3 class="text-xl font-semibold mb-4">报告管理</h3>
          <!-- 工作流监控、数据质量等 -->
        </div>
      </div>
    </div>

    <!-- 模态框用于添加/编辑注册表条目 -->
    <!-- 通用模态框用于添加/编辑注册表条目 -->
    <div id="registryEntryModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
      <div class="bg-white rounded-lg shadow-xl w-full max-w-lg max-h-[90vh] flex flex-col">
        <div class="flex justify-between items-center p-4 border-b">
          <h3 id="registryModalTitle" class="text-xl font-semibold text-gray-800">添加/编辑条目</h3>
          <button class="close-button text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
        </div>
        <div class="p-6 overflow-y-auto">
          <form id="registryEntryForm">
            <!-- 表单字段将根据注册表类型动态生成 -->
            <!-- 例如：
            <div class="mb-4">
                <label for="tech_name" class="block text-sm font-medium text-gray-700">技术名称</label>
                <input type="text" id="tech_name" name="tech_name" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm">
            </div>
            -->
          </form>
        </div>
        <div class="flex justify-end p-4 border-t">
          <button id="saveRegistryEntryBtn" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-blue-700">保存</button>
        </div>
      </div>
    </div>

    <!-- ============================================================ -->
    <!-- ============= 全局详情展示模态框 (MODAL) ================= -->
    <!-- ============================================================ -->
    <div id="detailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
      <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col">
        <!-- Modal Header -->
        <div class="flex justify-between items-center p-4 border-b">
          <h3 id="modalTitle" class="text-xl font-semibold text-gray-800">数据详情</h3>
          <button class="close-button text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
        </div>

        <!-- Modal Body -->
        <div class="p-6 overflow-y-auto">
          <div id="noDataMessage" class="text-center text-gray-500 py-8 hidden">没有找到相关数据。</div>
          <div class="overflow-x-auto">
              <table id="detailTable" class="w-full divide-y divide-gray-200 table-fixed">
                <!-- thead and tbody will be generated by JS -->
              </table>
          </div>
        </div>

        <!-- Modal Footer (for pagination, if needed later) -->
        <div class="modal-footer flex justify-between items-center p-4 border-t">
          <span id="paginationInfo" class="text-sm text-gray-600"></span>
          <div>
            <button id="prevPageBtn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 disabled:opacity-50">上一页</button>
            <button id="nextPageBtn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 disabled:opacity-50 ml-2">下一页</button>
          </div>
        </div>
      </div>
    </div>
        <!-- ============= 历史记录详情专用模态框 ================= -->
    <div id="historyDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
      <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col">
        <div class="flex justify-between items-center p-4 border-b">
          <h3 id="historyModalTitle" class="text-xl font-semibold text-gray-800">任务详情</h3>
          <button class="close-button text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
        </div>
        <div id="historyModalBody" class="p-6 overflow-y-auto">
          <!-- 内容将由JS填充 -->
        </div>
      </div>
    </div>

    <!-- 全局Toast通知容器 -->
    <div id="toast-notification" class="fixed top-5 right-5 bg-green-500 text-white py-2 px-4 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 ease-in-out z-[100]">
      <p id="toast-message">操作成功！</p>
    </div>

  </main>

  <?!= include('frontend/main.js.html'); ?>

</body>
</html>
